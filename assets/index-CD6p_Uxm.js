var L=Object.defineProperty;var O=(o,e,t)=>e in o?L(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var u=(o,e,t)=>O(o,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function t(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=t(s);fetch(s.href,n)}})();const _={0:[6,13],1:[6,12],2:[6,11],3:[6,10],4:[6,9],5:[5,8],6:[4,8],7:[3,8],8:[2,8],9:[1,8],10:[0,8],11:[0,7],12:[0,6],13:[1,6],14:[2,6],15:[3,6],16:[4,6],17:[5,6],18:[6,5],19:[6,4],20:[6,3],21:[6,2],22:[6,1],23:[6,0],24:[7,0],25:[8,0],26:[8,1],27:[8,2],28:[8,3],29:[8,4],30:[8,5],31:[9,6],32:[10,6],33:[11,6],34:[12,6],35:[13,6],36:[14,6],37:[14,7],38:[14,8],39:[13,8],40:[12,8],41:[11,8],42:[10,8],43:[9,8],44:[8,9],45:[8,10],46:[8,11],47:[8,12],48:[8,13],49:[8,14],50:[7,14],51:[6,14],100:[7,13],101:[7,12],102:[7,11],103:[7,10],104:[7,9],105:[7,8],200:[1,7],201:[1,8],202:[1,9],203:[1,10],204:[1,11],205:[1,12],300:[7,1],301:[7,2],302:[7,3],303:[7,4],304:[7,5],305:[7,6],200:[13,7],201:[13,8],202:[13,9],203:[13,10],204:[13,11],205:[13,12],500:[1.5,10.58],501:[3.57,10.58],502:[1.5,12.43],503:[3.57,12.43],600:[1.5,1.58],601:[3.57,1.58],602:[1.5,3.45],603:[3.57,3.45],700:[10.5,1.58],701:[12.54,1.58],702:[10.5,3.45],703:[12.54,3.45],800:[10.5,10.58],801:[12.54,10.58],802:[10.5,12.43],803:[12.54,12.43]},g=6.66,a=["P1","P2","P3","P4"],h={P1:[500,501,502,503],P2:[600,601,602,603],P3:[700,701,702,703],P4:[800,801,802,803]},D={P1:0,P2:13,P3:26,P4:39},E={P1:[100,101,102,103,104],P2:[200,201,202,203,204],P3:[300,301,302,303,304],P4:[400,401,402,403,404]},d={P1:105,P2:205,P2:305,P2:405},y={P1:50,P2:11,P3:24,P4:37},C=[0,8,13,21,26,34,39,47],l={DICE_NOT_ROLLED:"DICE_NOT_ROLLED",DICE_ROLLED:"DICE_ROLLED"},f=document.querySelector("#dice-btn"),P={P1:document.querySelectorAll('[player-id="P1"].player-piece'),P2:document.querySelectorAll('[player-id="P2"].player-piece'),P3:document.querySelectorAll('[player-id="P3"].player-piece'),P4:document.querySelectorAll('[player-id="P4"].player-piece')};class c{static listenDiceClick(e){f.addEventListener("click",e),window.addEventListener("keydown",t=>{t.keyCode===13&&e()})}static listenResetClick(e){document.querySelector("button#reset-btn").addEventListener("click",e)}static listenPieceClick(e){document.querySelector(".player-pieces").addEventListener("click",e)}static setPiecePosition(e,t,i){if(!P[e]||!P[e][t]){console.error(`Player element of given player: ${e} and piece: ${t} not found`);return}const[s,n]=_[i],r=P[e][t];r.style.top=n*g+"%",r.style.left=s*g+"%"}static setTurn(e){if(e<0||e>=a.length){console.error("index out of bound!");return}const t=a[e];document.querySelector(".active-player span").innerText=t;const i=document.querySelector(".player-base.highlight");i&&i.classList.remove("highlight"),document.querySelector(`[player-id="${t}"].player-base`).classList.add("highlight")}static enableDice(){f.removeAttribute("disabled")}static disableDice(){f.setAttribute("disabled","")}static highlightPieces(e,t){t.forEach(i=>{P[e][i].classList.add("highlight")})}static unhighlightPieces(){document.querySelectorAll(".player-piece.highlight").forEach(e=>{e.classList.remove("highlight")})}static setDiceValue(e){document.querySelector(".dice-value").innerText=e}}class S{constructor(){u(this,"currentPositions",{P1:[],P2:[],P3:[],P4:[]});u(this,"_diceValue");u(this,"_turn");u(this,"_state");console.log("Hello World! Lets play Ludo!"),this.listenDiceClick(),this.listenResetClick(),this.listenPieceClick(),this.resetGame()}get diceValue(){return this._diceValue}set diceValue(e){this._diceValue=e,c.setDiceValue(e)}get turn(){return this._turn}set turn(e){this._turn=e,c.setTurn(e)}get state(){return this._state}set state(e){this._state=e,e===l.DICE_NOT_ROLLED?(c.enableDice(),c.unhighlightPieces()):c.disableDice()}listenDiceClick(){c.listenDiceClick(this.onDiceClick.bind(this))}onDiceClick(){console.log("dice clicked!"),this.diceValue=1+Math.floor(Math.random()*6),this.state=l.DICE_ROLLED,this.checkForEligiblePieces()}checkForEligiblePieces(){const e=a[this.turn],t=this.getEligiblePieces(e);t.length?c.highlightPieces(e,t):this.incrementTurn()}incrementTurn(){this.turn===3?this.turn=0:this.turn++,this.state=l.DICE_NOT_ROLLED}getEligiblePieces(e){return[0,1,2,3].filter(t=>{const i=this.currentPositions[e][t];return!(i===d[e]||h[e].includes(i)&&this.diceValue!==6||E[e].includes(i)&&this.diceValue>d[e]-i)})}listenResetClick(){c.listenResetClick(this.resetGame.bind(this))}resetGame(){confirm("Are you sure you want to reset this game")&&(console.log("reset game"),this.currentPositions=structuredClone(h),a.forEach(e=>{[0,1,2,3].forEach(t=>{this.setPiecePosition(e,t,this.currentPositions[e][t])})}),this.turn=0,this.state=l.DICE_NOT_ROLLED)}listenPieceClick(){c.listenPieceClick(this.onPieceClick.bind(this))}onPieceClick(e){const t=e.target;if(!t.classList.contains("player-piece")||!t.classList.contains("highlight"))return;console.log("piece clicked");const i=t.getAttribute("player-id"),s=t.getAttribute("piece");this.handlePieceClick(i,s)}handlePieceClick(e,t){console.log(e,t);const i=this.currentPositions[e][t];if(h[e].includes(i)){this.setPiecePosition(e,t,D[e]),this.state=l.DICE_NOT_ROLLED;return}c.unhighlightPieces(),this.movePiece(e,t,this.diceValue)}setPiecePosition(e,t,i){this.currentPositions[e][t]=i,c.setPiecePosition(e,t,i)}movePiece(e,t,i){const s=setInterval(()=>{if(this.incrementPiecePosition(e,t),i--,i===0){if(clearInterval(s),this.hasPlayerWon(e)){alert(`Player: ${e} has won!`),this.resetGame();return}if(this.checkForKill(e,t)||this.diceValue===6){this.state=l.DICE_NOT_ROLLED;return}this.incrementTurn()}},200)}checkForKill(e,t){const i=this.currentPositions[e][t];let s=e==="P1"?"P2":e==="P2"?"P3":e==="P3"?"P4":"P1",n=!1;return[0,1,2,3].forEach(r=>{const m=this.currentPositions[s][r];i===m&&!C.includes(i)&&(this.setPiecePosition(s,r,h[s][r]),n=!0)}),n}hasPlayerWon(e){return[0,1,2,3].every(t=>this.currentPositions[e][t]===d[e])}incrementPiecePosition(e,t){this.setPiecePosition(e,t,this.getIncrementedPosition(e,t))}getIncrementedPosition(e,t){const i=this.currentPositions[e][t];return i===y[e]?E[e][0]:i===51?0:i+1}}new S;
